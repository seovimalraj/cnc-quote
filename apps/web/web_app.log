nohup: ignoring input

> @cnc-quote/web@0.1.0 dev /workspaces/cnc-quote/apps/web
> next dev

   â–² Next.js 15.5.3
   - Local:        http://localhost:3000
   - Network:      http://10.0.0.59:3000
   - Environments: .env
   - Experiments (use with caution):
     Â· serverActions
     âœ“ forceSwcTransforms

 âœ“ Starting...
 âœ“ Ready in 1655ms
 â—‹ Compiling /api/files/upload ...
 â¨¯ ./src/app/api/files/upload/route.ts
Error:   [31mx[0m Expected a semicolon
    ,-[[36;1;4m/workspaces/cnc-quote/apps/web/src/app/api/files/upload/route.ts[0m:76:1]
 [2m73[0m |         'Access-Control-Allow-Headers': 'Content-Type'
 [2m74[0m |       }
 [2m75[0m |     });
 [2m76[0m |       }, {
    : [35;1m       ^[0m
 [2m77[0m |         headers: {
 [2m78[0m |           'Access-Control-Allow-Origin': '*',
 [2m79[0m |           'Access-Control-Allow-Methods': 'PUT, POST, GET, OPTIONS',
    `----
  [31mx[0m Expression expected
    ,-[[36;1;4m/workspaces/cnc-quote/apps/web/src/app/api/files/upload/route.ts[0m:76:1]
 [2m73[0m |         'Access-Control-Allow-Headers': 'Content-Type'
 [2m74[0m |       }
 [2m75[0m |     });
 [2m76[0m |       }, {
    : [35;1m       ^[0m
 [2m77[0m |         headers: {
 [2m78[0m |           'Access-Control-Allow-Origin': '*',
 [2m79[0m |           'Access-Control-Allow-Methods': 'PUT, POST, GET, OPTIONS',
    `----

Caused by:
    Syntax Error

Import trace for requested module:
./src/app/api/files/upload/route.ts
 â¨¯ ./src/app/api/files/upload/route.ts
Error:   [31mx[0m Expected a semicolon
    ,-[[36;1;4m/workspaces/cnc-quote/apps/web/src/app/api/files/upload/route.ts[0m:76:1]
 [2m73[0m |         'Access-Control-Allow-Headers': 'Content-Type'
 [2m74[0m |       }
 [2m75[0m |     });
 [2m76[0m |       }, {
    : [35;1m       ^[0m
 [2m77[0m |         headers: {
 [2m78[0m |           'Access-Control-Allow-Origin': '*',
 [2m79[0m |           'Access-Control-Allow-Methods': 'PUT, POST, GET, OPTIONS',
    `----
  [31mx[0m Expression expected
    ,-[[36;1;4m/workspaces/cnc-quote/apps/web/src/app/api/files/upload/route.ts[0m:76:1]
 [2m73[0m |         'Access-Control-Allow-Headers': 'Content-Type'
 [2m74[0m |       }
 [2m75[0m |     });
 [2m76[0m |       }, {
    : [35;1m       ^[0m
 [2m77[0m |         headers: {
 [2m78[0m |           'Access-Control-Allow-Origin': '*',
 [2m79[0m |           'Access-Control-Allow-Methods': 'PUT, POST, GET, OPTIONS',
    `----

Caused by:
    Syntax Error

Import trace for requested module:
./src/app/api/files/upload/route.ts
 â¨¯ ./src/app/api/files/upload/route.ts
Error:   [31mx[0m Expected a semicolon
    ,-[[36;1;4m/workspaces/cnc-quote/apps/web/src/app/api/files/upload/route.ts[0m:76:1]
 [2m73[0m |         'Access-Control-Allow-Headers': 'Content-Type'
 [2m74[0m |       }
 [2m75[0m |     });
 [2m76[0m |       }, {
    : [35;1m       ^[0m
 [2m77[0m |         headers: {
 [2m78[0m |           'Access-Control-Allow-Origin': '*',
 [2m79[0m |           'Access-Control-Allow-Methods': 'PUT, POST, GET, OPTIONS',
    `----
  [31mx[0m Expression expected
    ,-[[36;1;4m/workspaces/cnc-quote/apps/web/src/app/api/files/upload/route.ts[0m:76:1]
 [2m73[0m |         'Access-Control-Allow-Headers': 'Content-Type'
 [2m74[0m |       }
 [2m75[0m |     });
 [2m76[0m |       }, {
    : [35;1m       ^[0m
 [2m77[0m |         headers: {
 [2m78[0m |           'Access-Control-Allow-Origin': '*',
 [2m79[0m |           'Access-Control-Allow-Methods': 'PUT, POST, GET, OPTIONS',
    `----

Caused by:
    Syntax Error

Import trace for requested module:
./src/app/api/files/upload/route.ts
 POST /api/files/upload 500 in 12837ms
 â¨¯ ./src/app/api/files/upload/route.ts
Error:   [31mx[0m Expected a semicolon
    ,-[[36;1;4m/workspaces/cnc-quote/apps/web/src/app/api/files/upload/route.ts[0m:79:1]
 [2m76[0m |     }
 [2m77[0m | 
 [2m78[0m |     // For development, skip Supabase authentication and use mock upload
 [2m79[0m |     console.log('Development mode: Skipping Supabase authentication');
    : [35;1m    ^[0m
 [2m80[0m | 
 [2m81[0m |     return NextResponse.json({
 [2m82[0m |       fileId,
    `----
  [31mx[0m Expected a semicolon
    ,-[[36;1;4m/workspaces/cnc-quote/apps/web/src/app/api/files/upload/route.ts[0m:92:1]
 [2m89[0m |         'Access-Control-Allow-Methods': 'PUT, POST, GET, OPTIONS',
 [2m90[0m |         'Access-Control-Allow-Headers': 'Content-Type'
 [2m91[0m |       }
 [2m92[0m |     });  } catch (error) {
    : [35;1m           ^^^^^[0m
 [2m93[0m |     console.error('File upload preparation error:', error);
 [2m94[0m | 
 [2m95[0m |     // Provide more detailed error information
    `----
  [31mx[0m Return statement is not allowed here
     ,-[[36;1;4m/workspaces/cnc-quote/apps/web/src/app/api/files/upload/route.ts[0m:106:1]
 [2m103[0m |           name: error instanceof Error ? error.name : 'Unknown'
 [2m104[0m |         });
 [2m105[0m |     
 [2m106[0m | [35;1m,[0m[35;1m-[0m[35;1m>[0m     return NextResponse.json(
 [2m107[0m | [35;1m|[0m         {
 [2m108[0m | [35;1m|[0m           error: 'Failed to prepare file upload',
 [2m109[0m | [35;1m|[0m           details: process.env.NODE_ENV === 'development' ? errorMessage : undefined
 [2m110[0m | [35;1m|[0m         },
 [2m111[0m | [35;1m|[0m         { status: 500 }
 [2m112[0m | [35;1m`[0m[35;1m-[0m[35;1m>[0m     );
 [2m113[0m |       }
 [2m114[0m |     }
     `----
  [31mx[0m Expression expected
     ,-[[36;1;4m/workspaces/cnc-quote/apps/web/src/app/api/files/upload/route.ts[0m:114:1]
 [2m111[0m |       { status: 500 }
 [2m112[0m |     );
 [2m113[0m |   }
 [2m114[0m | }
     : [35;1m^[0m
     `----

Caused by:
    Syntax Error

Import trace for requested module:
./src/app/api/files/upload/route.ts
 POST /api/files/upload 500 in 25ms
 âœ“ Compiled /middleware in 678ms (159 modules)
 â—‹ Compiling /instant-quote ...
 â¨¯ ./src/app/api/files/upload/route.ts
Error:   [31mx[0m Expected a semicolon
    ,-[[36;1;4m/workspaces/cnc-quote/apps/web/src/app/api/files/upload/route.ts[0m:79:1]
 [2m76[0m |     }
 [2m77[0m | 
 [2m78[0m |     // For development, skip Supabase authentication and use mock upload
 [2m79[0m |     console.log('Development mode: Skipping Supabase authentication');
    : [35;1m    ^[0m
 [2m80[0m | 
 [2m81[0m |     return NextResponse.json({
 [2m82[0m |       fileId,
    `----
  [31mx[0m Expected a semicolon
    ,-[[36;1;4m/workspaces/cnc-quote/apps/web/src/app/api/files/upload/route.ts[0m:92:1]
 [2m89[0m |         'Access-Control-Allow-Methods': 'PUT, POST, GET, OPTIONS',
 [2m90[0m |         'Access-Control-Allow-Headers': 'Content-Type'
 [2m91[0m |       }
 [2m92[0m |     });  } catch (error) {
    : [35;1m           ^^^^^[0m
 [2m93[0m |     console.error('File upload preparation error:', error);
 [2m94[0m | 
 [2m95[0m |     // Provide more detailed error information
    `----
  [31mx[0m Return statement is not allowed here
     ,-[[36;1;4m/workspaces/cnc-quote/apps/web/src/app/api/files/upload/route.ts[0m:106:1]
 [2m103[0m |           name: error instanceof Error ? error.name : 'Unknown'
 [2m104[0m |         });
 [2m105[0m |     
 [2m106[0m | [35;1m,[0m[35;1m-[0m[35;1m>[0m     return NextResponse.json(
 [2m107[0m | [35;1m|[0m         {
 [2m108[0m | [35;1m|[0m           error: 'Failed to prepare file upload',
 [2m109[0m | [35;1m|[0m           details: process.env.NODE_ENV === 'development' ? errorMessage : undefined
 [2m110[0m | [35;1m|[0m         },
 [2m111[0m | [35;1m|[0m         { status: 500 }
 [2m112[0m | [35;1m`[0m[35;1m-[0m[35;1m>[0m     );
 [2m113[0m |       }
 [2m114[0m |     }
     `----
  [31mx[0m Expression expected
     ,-[[36;1;4m/workspaces/cnc-quote/apps/web/src/app/api/files/upload/route.ts[0m:114:1]
 [2m111[0m |       { status: 500 }
 [2m112[0m |     );
 [2m113[0m |   }
 [2m114[0m | }
     : [35;1m^[0m
     `----

Caused by:
    Syntax Error

Import trace for requested module:
./src/app/api/files/upload/route.ts
 GET /instant-quote 500 in 1649ms
 âœ“ Compiled /instant-quote in 1060ms (798 modules)
 âš  Fast Refresh had to perform a full reload due to a runtime error.
 âœ“ Compiled /instant-quote in 453ms (803 modules)
 GET /instant-quote 200 in 583ms
 â—‹ Compiling /api/auth/me ...
 âœ“ Compiled /api/auth/me in 1287ms (1403 modules)
 GET /api/auth/me 200 in 1497ms
 âœ“ Compiled /api/files/upload in 264ms (915 modules)
File upload request received
Request body parsed: {
  fileName: 'test.step',
  fileSize: 1024000,
  contentType: 'application/step'
}
File details: {
  fileName: 'test.step',
  fileSize: 1024000,
  contentType: 'application/step'
}
Development mode: Using mock upload URL
 POST /api/files/upload 200 in 368ms
 GET /instant-quote 200 in 283ms
 GET /api/auth/me 200 in 48ms
File upload request received
Request body parsed: {
  fileName: '439377-Gears2.stl',
  fileSize: 572884,
  contentType: 'model/stl'
}
File details: {
  fileName: '439377-Gears2.stl',
  fileSize: 572884,
  contentType: 'model/stl'
}
Development mode: Using mock upload URL
 POST /api/files/upload 200 in 41ms
 â—‹ Compiling /api/quotes ...
 âœ“ Compiled /api/quotes in 697ms (1407 modules)
 POST /api/quotes 200 in 849ms
 âœ“ Compiled /api/quotes/[id]/lines in 378ms (1409 modules)
Error: Route "/api/quotes/[id]/lines" used `params.id`. `params` should be awaited before using its properties. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at POST (src/app/api/quotes/[id]/lines/route.ts:8:28)
   6 | ) {
   7 |   try {
>  8 |     const quoteId = params.id;
     |                            ^
   9 |     const body = await request.json();
  10 |     const { fileId, fileName, fileSize } = body;
  11 |
 POST /api/quotes/Q339509/lines 200 in 1078ms
 âœ“ Compiled /api/cad/analyze in 292ms (1318 modules)
 POST /api/cad/analyze 200 in 362ms
 â—‹ Compiling /api/price ...
 âœ“ Compiled /api/price in 618ms (1322 modules)
Pricing calculation error: TypeError: Cannot read properties of undefined (reading 'toLowerCase')
    at calculateCycleCost (src/app/api/price/route.ts:116:52)
    at POST (src/app/api/price/route.ts:198:24)
  114 | function calculateCycleCost(volume_removed: number, surface_area: number, features: number, material: string, tolerance_pack: string): number {
  115 |   const machine = mockPricingConfig.machines['3-axis-milling'];
> 116 |   const feed_rate = machine.feed_rate_map[material.toLowerCase()] || 600;
      |                                                    ^
  117 |   const tolerance_mult = mockPricingConfig.tolerance_packs[tolerance_pack]?.cycle_time_multiplier || 1.0;
  118 |
  119 |   // Simplified cycle time calculation
 POST /api/price 500 in 665ms
Error: Route "/api/quotes/[id]" used `params.id`. `params` should be awaited before using its properties. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at GET (src/app/api/quotes/[id]/route.ts:136:28)
  134 | ) {
  135 |   try {
> 136 |     const quoteId = params.id;
      |                            ^
  137 |
  138 |     // Generate dynamic mock data based on quote ID
  139 |     const seed = quoteId.split('').reduce((acc, char) => acc + char.charCodeAt(0), 0);
 GET /api/quotes/Q339509 200 in 1365ms
Error: Route "/api/quotes/[id]" used `params.id`. `params` should be awaited before using its properties. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at GET (src/app/api/quotes/[id]/route.ts:136:28)
  134 | ) {
  135 |   try {
> 136 |     const quoteId = params.id;
      |                            ^
  137 |
  138 |     // Generate dynamic mock data based on quote ID
  139 |     const seed = quoteId.split('').reduce((acc, char) => acc + char.charCodeAt(0), 0);
 GET /api/quotes/Q339509 200 in 109ms
Error: Route "/api/quotes/[id]" used `params.id`. `params` should be awaited before using its properties. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at GET (src/app/api/quotes/[id]/route.ts:136:28)
  134 | ) {
  135 |   try {
> 136 |     const quoteId = params.id;
      |                            ^
  137 |
  138 |     // Generate dynamic mock data based on quote ID
  139 |     const seed = quoteId.split('').reduce((acc, char) => acc + char.charCodeAt(0), 0);
 GET /api/quotes/Q339509 200 in 100ms
Error: Route "/api/quotes/[id]" used `params.id`. `params` should be awaited before using its properties. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at GET (src/app/api/quotes/[id]/route.ts:136:28)
  134 | ) {
  135 |   try {
> 136 |     const quoteId = params.id;
      |                            ^
  137 |
  138 |     // Generate dynamic mock data based on quote ID
  139 |     const seed = quoteId.split('').reduce((acc, char) => acc + char.charCodeAt(0), 0);
 GET /api/quotes/Q339509 200 in 129ms
 â—‹ Compiling /api/leads ...
 âœ“ Compiled /api/leads in 547ms (1324 modules)
Failed to send welcome email: ReferenceError: Cannot access 'mockLead' before initialization
    at POST (src/app/api/leads/route.ts:101:21)
   99 |             email,
  100 |             quoteId,
> 101 |             leadId: mockLead.id
      |                     ^
  102 |           }
  103 |         })
  104 |       });
 POST /api/leads 200 in 680ms
 â—‹ Compiling /quote/[id] ...
CAD analysis completed for file file_1757623332114_59za482xm
 â¨¯ ../../node_modules/.pnpm/three-mesh-bvh@0.7.8_three@0.158.0/node_modules/three-mesh-bvh/src/utils/ExtensionUtilities.js
Attempted import error: 'BatchedMesh' is not exported from 'three' (imported as 'THREE').

Import trace for requested module:
../../node_modules/.pnpm/three-mesh-bvh@0.7.8_three@0.158.0/node_modules/three-mesh-bvh/src/utils/ExtensionUtilities.js
../../node_modules/.pnpm/three-mesh-bvh@0.7.8_three@0.158.0/node_modules/three-mesh-bvh/src/index.js
../../node_modules/.pnpm/@react-three+drei@9.122.0_@react-three+fiber@8.15.19_@types+react@18.3.24_@types+three@0.158._hgqbnlsqteyg267kl6o3xomyfi/node_modules/@react-three/drei/core/Bvh.js
../../node_modules/.pnpm/@react-three+drei@9.122.0_@react-three+fiber@8.15.19_@types+react@18.3.24_@types+three@0.158._hgqbnlsqteyg267kl6o3xomyfi/node_modules/@react-three/drei/index.js
./src/components/Model3DViewer.tsx
./src/app/quote/[id]/page.tsx
 GET /api/quotes/Q339509 500 in 9898ms
 â¨¯ ../../node_modules/.pnpm/three-mesh-bvh@0.7.8_three@0.158.0/node_modules/three-mesh-bvh/src/utils/ExtensionUtilities.js
Attempted import error: 'BatchedMesh' is not exported from 'three' (imported as 'THREE').

Import trace for requested module:
../../node_modules/.pnpm/three-mesh-bvh@0.7.8_three@0.158.0/node_modules/three-mesh-bvh/src/utils/ExtensionUtilities.js
../../node_modules/.pnpm/three-mesh-bvh@0.7.8_three@0.158.0/node_modules/three-mesh-bvh/src/index.js
../../node_modules/.pnpm/@react-three+drei@9.122.0_@react-three+fiber@8.15.19_@types+react@18.3.24_@types+three@0.158._hgqbnlsqteyg267kl6o3xomyfi/node_modules/@react-three/drei/core/Bvh.js
../../node_modules/.pnpm/@react-three+drei@9.122.0_@react-three+fiber@8.15.19_@types+react@18.3.24_@types+three@0.158._hgqbnlsqteyg267kl6o3xomyfi/node_modules/@react-three/drei/index.js
./src/components/Model3DViewer.tsx
./src/app/quote/[id]/page.tsx
 GET /quote/Q339509 500 in 12757ms
 â¨¯ ../../node_modules/.pnpm/three-mesh-bvh@0.7.8_three@0.158.0/node_modules/three-mesh-bvh/src/utils/ExtensionUtilities.js
Attempted import error: 'BatchedMesh' is not exported from 'three' (imported as 'THREE').

Import trace for requested module:
../../node_modules/.pnpm/three-mesh-bvh@0.7.8_three@0.158.0/node_modules/three-mesh-bvh/src/utils/ExtensionUtilities.js
../../node_modules/.pnpm/three-mesh-bvh@0.7.8_three@0.158.0/node_modules/three-mesh-bvh/src/index.js
../../node_modules/.pnpm/@react-three+drei@9.122.0_@react-three+fiber@8.15.19_@types+react@18.3.24_@types+three@0.158._hgqbnlsqteyg267kl6o3xomyfi/node_modules/@react-three/drei/core/Bvh.js
../../node_modules/.pnpm/@react-three+drei@9.122.0_@react-three+fiber@8.15.19_@types+react@18.3.24_@types+three@0.158._hgqbnlsqteyg267kl6o3xomyfi/node_modules/@react-three/drei/index.js
./src/components/Model3DViewer.tsx
./src/app/quote/[id]/page.tsx
 â¨¯ ../../node_modules/.pnpm/three-mesh-bvh@0.7.8_three@0.158.0/node_modules/three-mesh-bvh/src/utils/ExtensionUtilities.js
Attempted import error: 'BatchedMesh' is not exported from 'three' (imported as 'THREE').

Import trace for requested module:
../../node_modules/.pnpm/three-mesh-bvh@0.7.8_three@0.158.0/node_modules/three-mesh-bvh/src/utils/ExtensionUtilities.js
../../node_modules/.pnpm/three-mesh-bvh@0.7.8_three@0.158.0/node_modules/three-mesh-bvh/src/index.js
../../node_modules/.pnpm/@react-three+drei@9.122.0_@react-three+fiber@8.15.19_@types+react@18.3.24_@types+three@0.158._hgqbnlsqteyg267kl6o3xomyfi/node_modules/@react-three/drei/core/Bvh.js
../../node_modules/.pnpm/@react-three+drei@9.122.0_@react-three+fiber@8.15.19_@types+react@18.3.24_@types+three@0.158._hgqbnlsqteyg267kl6o3xomyfi/node_modules/@react-three/drei/index.js
./src/components/Model3DViewer.tsx
./src/app/quote/[id]/page.tsx
 â¨¯ ../../node_modules/.pnpm/three-mesh-bvh@0.7.8_three@0.158.0/node_modules/three-mesh-bvh/src/utils/ExtensionUtilities.js
Attempted import error: 'BatchedMesh' is not exported from 'three' (imported as 'THREE').

Import trace for requested module:
../../node_modules/.pnpm/three-mesh-bvh@0.7.8_three@0.158.0/node_modules/three-mesh-bvh/src/utils/ExtensionUtilities.js
../../node_modules/.pnpm/three-mesh-bvh@0.7.8_three@0.158.0/node_modules/three-mesh-bvh/src/index.js
../../node_modules/.pnpm/@react-three+drei@9.122.0_@react-three+fiber@8.15.19_@types+react@18.3.24_@types+three@0.158._hgqbnlsqteyg267kl6o3xomyfi/node_modules/@react-three/drei/core/Bvh.js
../../node_modules/.pnpm/@react-three+drei@9.122.0_@react-three+fiber@8.15.19_@types+react@18.3.24_@types+three@0.158._hgqbnlsqteyg267kl6o3xomyfi/node_modules/@react-three/drei/index.js
./src/components/Model3DViewer.tsx
./src/app/quote/[id]/page.tsx
 â¨¯ ../../node_modules/.pnpm/three-mesh-bvh@0.7.8_three@0.158.0/node_modules/three-mesh-bvh/src/utils/ExtensionUtilities.js
Attempted import error: 'BatchedMesh' is not exported from 'three' (imported as 'THREE').

Import trace for requested module:
../../node_modules/.pnpm/three-mesh-bvh@0.7.8_three@0.158.0/node_modules/three-mesh-bvh/src/utils/ExtensionUtilities.js
../../node_modules/.pnpm/three-mesh-bvh@0.7.8_three@0.158.0/node_modules/three-mesh-bvh/src/index.js
../../node_modules/.pnpm/@react-three+drei@9.122.0_@react-three+fiber@8.15.19_@types+react@18.3.24_@types+three@0.158._hgqbnlsqteyg267kl6o3xomyfi/node_modules/@react-three/drei/core/Bvh.js
../../node_modules/.pnpm/@react-three+drei@9.122.0_@react-three+fiber@8.15.19_@types+react@18.3.24_@types+three@0.158._hgqbnlsqteyg267kl6o3xomyfi/node_modules/@react-three/drei/index.js
./src/components/Model3DViewer.tsx
./src/app/quote/[id]/page.tsx
 â¨¯ [Error: ENOENT: no such file or directory, open '/workspaces/cnc-quote/apps/web/.next/fallback-build-manifest.json'] {
  errno: -2,
  code: 'ENOENT',
  syscall: 'open',
  path: '/workspaces/cnc-quote/apps/web/.next/fallback-build-manifest.json'
}
[Error: ENOENT: no such file or directory, open '/workspaces/cnc-quote/apps/web/.next/fallback-build-manifest.json'] {
  errno: -2,
  code: 'ENOENT',
  syscall: 'open',
  path: '/workspaces/cnc-quote/apps/web/.next/fallback-build-manifest.json'
}
[Error: ENOENT: no such file or directory, open '/workspaces/cnc-quote/apps/web/.next/fallback-build-manifest.json'] {
  errno: -2,
  code: 'ENOENT',
  syscall: 'open',
  path: '/workspaces/cnc-quote/apps/web/.next/fallback-build-manifest.json'
}
â€‰ELIFECYCLEâ€‰ Command failed.
[?25h
